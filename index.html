<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Time Zone Converter</title>
  <style>
    :root {
      --bg: #eef4ff;
      --card: #ffffff;
      --border: #d6e2ff;
      --text: #0f1c3f;
      --muted: #6b7a99;
      --accent: #3b82f6;
      --accent-light: #e3edff;
      --radius: 14px;
      --ist-accent: #06b6d4;
      --est-accent: #ef4444;
      --syd-accent: #06b64f;
      --ber-accent: #7c3aed;
      --container-max: 1100px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
      background: linear-gradient(180deg, #eef4ff 0%, #dae7ff 100%);
      color: var(--text);
      padding: 28px 14px;
      display: flex;
      justify-content: center;
    }

    .page {
      width: 100%;
      max-width: var(--container-max);
    }

    h1 {
      margin: 0 0 18px 0;
      font-size: 28px;
      font-weight: 700;
      color: #143370;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 22px;
      box-shadow: 0 6px 18px rgba(30, 64, 175, 0.06);
    }

    h3 {
      margin-top: 0;
      font-size: 18px;
      color: #1e3a8a;
    }

    .label {
      margin: 0 0 6px;
      font-size: 14px;
      color: var(--muted);
      display: inline-block;
      vertical-align: middle;
    }

    select {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--accent-light);
      font-size: 15px;
    }

    input[type="datetime-local"] {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 15px;
      background: var(--accent-light);
      outline: none;
    }

    input[type="datetime-local"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 6px rgba(59, 130, 246, 0.45);
      background: white;
    }

    .prominent {
      display: flex;
      gap: 16px;
      align-items: flex-start;
      margin-top: 14px;
    }

    /* est box */
    .est-box {
      flex: 0 0 420px;
      min-width: 260px;
      background: linear-gradient(90deg, #fff2f2, #fff);
      border: 1px solid rgba(239, 68, 68, 0.12);
      padding: 18px 22px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(239, 68, 68, 0.06);
      transition: box-shadow 0.2s ease, border-color 0.2s ease, opacity 0.2s ease;
    }

    .est-box .label {
      color: #b91c1c;
      font-weight: 800;
      font-size: 14px;
    }

    .est-box .big {
      font-size: 28px;
      font-weight: 900;
      color: #7f1d1d;
      margin-top: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .prominent .others {
      display: flex;
      gap: 10px;
      flex-direction: column;
      flex: 1 1 auto;
    }

    /* zone table */
    .zone-table {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .zone-row {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 10px;
      background: linear-gradient(180deg, #fff, var(--accent-light));
      border: 1px solid rgba(15, 23, 42, 0.03);
      box-shadow: 0 4px 12px rgba(2, 6, 23, 0.03);
      transition: box-shadow 0.2s ease, border-color 0.2s ease, opacity 0.2s ease;
    }

    .zone-row+.zone-row {
      margin-top: 4px;
    }

    .zone-name {
      font-weight: 800;
      color: var(--text);
      font-size: 15px;
    }

    /* AM/PM tone styles */
    .time-am {
      color: #a9b409;
      background-color: rgba(237, 251, 36, 0.18);
    }

    .time-pm {
      color: #1e3a8a;
      background-color: rgba(37, 99, 235, 0.18);
    }

    .zone-value {
      font-weight: 700;
      color: #1e40af;
      font-size: 15px;
      text-align: right;
    }

    .zone-row[data-zone="apac"] {
      border-left: 6px solid var(--syd-accent);
    }

    .zone-row[data-zone="emea"] {
      border-left: 6px solid var(--ber-accent);
    }

    .zone-row[data-zone="clar"] {
      border-left: 6px solid var(--est-accent);
    }

    .ctrls {
      display: none;
    }

    .slide-anim {
      transition: none;
    }

    .header-controls {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .sort-btn {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, #fff, var(--accent-light));
      cursor: pointer;
      font-size: 14px;
    }

    .sort-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Meeting planner / business hours shading – color the chips themselves */
    .row-business-core {
      background: linear-gradient(180deg, #ecfdf3, #dcfce7);
      /* soft green */
      border-color: rgba(22, 163, 74, 0.35);
      box-shadow: 0 4px 10px rgba(22, 163, 74, 0.12);
    }

    .row-business-extended {
      background: linear-gradient(180deg, #f9fafb, #e5e7eb);
      /* neutral grey */
      border-color: rgba(148, 163, 184, 0.4);
      box-shadow: 0 2px 6px rgba(15, 23, 42, 0.06);
      opacity: 0.95;
    }

    .row-business-off {
      background: linear-gradient(180deg, #f9fafb, #e5e7eb);
      /* neutral grey */
      border-color: rgba(148, 163, 184, 0.4);
      box-shadow: 0 2px 6px rgba(15, 23, 42, 0.06);
      opacity: 0.95;
    }

    .zone-diff {
      font-size: 11px;
      font-weight: 600;
      display: inline-block;
      margin-top: 4px;
      padding: 2px 8px;
      border-radius: 10px;
      background: rgba(148, 163, 184, 0.18);
      /* soft slate */
      color: #334155;
    }

    .zone-diff-ist {
      background: rgba(99, 102, 241, 0.18);
      /* indigo tint */
      color: #3730a3;
    }

    .zone-diff-utc {
      background: rgba(249, 115, 22, 0.18);
      /* warm orange tint */
      color: #9a3412;
    }

    /* stack IST+UTC diffs neatly when both present */
    .zone-diff-wrap {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }


    /* MOBILE / SMALL SCREENS */
    @media (max-width: 820px) {
      body {
        padding: 18px 12px;
      }

      .card {
        padding: 16px;
        margin-bottom: 18px;
      }

      h1 {
        font-size: 22px;
        margin-bottom: 12px;
      }

      .prominent {
        gap: 12px;
      }

      .est-box {
        flex: 0 0 auto;
        width: 100%;
        min-width: 0;
        padding: 14px;
      }

      .est-box .big {
        font-size: 20px;
      }

      .prominent .others {
        gap: 8px;
      }

      /* move controls to stacked layout */
      .prominent {
        flex-direction: column;
      }

      .header-controls {
        width: 100%;
        justify-content: flex-start;
        gap: 8px;
      }

      /* make the left column (select/sort) flow naturally */
      .card>div[style*="display:flex"] {
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
      }

      .card>div[style*="display:flex"] .header-controls {
        justify-content: flex-start;
      }

      /* zone rows stack values underneath names on small screens */
      .zone-row {
        grid-template-columns: 1fr;
      }

      .zone-value {
        text-align: left;
        margin-top: 8px;
        font-size: 15px;
      }

      /* make inputs and buttons easier to tap */
      select,
      .sort-btn,
      input[type="datetime-local"] {
        width: 100%;
      }

      .sort-btn {
        padding: 12px;
        font-size: 15px;
      }
    }

    /* VERY SMALL (phone portrait) tweaks */
    @media (max-width: 420px) {
      .est-box .big {
        font-size: 18px;
      }

      .zone-name {
        font-size: 14px;
      }

      .zone-value {
        font-size: 14px;
      }

      .sort-btn {
        padding: 10px;
        font-size: 14px;
      }

      .label {
        font-size: 13px;
      }

      .card {
        padding: 12px;
      }

    }
  </style>
</head>

<body>
  <div class="page">
    <h1>Time Zone Converter</h1>

    <div class="card">
      <h3>Live Time</h3>

      <div style="display:flex; gap:14px; align-items:center;">
        <div style="flex:0 0 420px; display:flex; gap:8px; align-items:center;">
          <div style="min-width:140px;">
            <label class="label">Select Region:</label>
            <select id="groupSelectLive" onchange="applyGroupLive()">
              <option value="all">All</option>
              <option value="apac">APAC</option>
              <option value="emea">EMEA</option>
              <option value="clar">CLAR</option>
            </select>
          </div>
          <div class="header-controls">
            <div>
              <label class="label">Apply Sorting:</label>
              <div>
                <button class="sort-btn" data-target="liveTable" data-dir="asc"
                  onclick="sortZones('liveTable', true)">Ascending</button>
                <button class="sort-btn" data-target="liveTable" data-dir="desc"
                  onclick="sortZones('liveTable', false)">Descending</button>
              </div>
            </div>
          </div>
        </div>
        <div style="flex:1"></div>
      </div>

      <div class="prominent">
        <div class="est-box" id="liveEstBox">
          <div class="label">Primary Live — EST</div>
          <div id="liveEST" class="big">--</div>
          <div class="sub" style="margin-top:6px">America/New_York</div>
        </div>

        <div class="others" id="liveChips">
          <div class="zone-table" id="liveTable">

            <div class="zone-row" data-zone="clar" data-key="MEX" data-tz="America/Mexico_City">
              <div class="zone-name">Mexico (America/Mexico_City)</div>
              <div class="zone-value" id="liveMEX">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveMEX"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveMEX"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="clar" data-key="CAN" data-tz="America/Toronto">
              <div class="zone-name">Canada (America/Toronto)</div>
              <div class="zone-value" id="liveCAN">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveCAN"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveCAN"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="clar" data-key="BRA" data-tz="Brazil/East">
              <div class="zone-name">Brazil (Brazil/East)</div>
              <div class="zone-value" id="liveBRA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveBRA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveBRA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="BER" data-tz="Europe/Berlin">
              <div class="zone-name">Belgium (Europe/Berlin)</div>
              <div class="zone-value" id="liveBER">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveBER"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveBER"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="FRA" data-tz="Europe/Berlin">
              <div class="zone-name">France (Europe/Berlin)</div>
              <div class="zone-value" id="liveFRA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveFRA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveFRA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="DEU" data-tz="Europe/Berlin">
              <div class="zone-name">Germany (Europe/Berlin)</div>
              <div class="zone-value" id="liveDEU">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveDEU"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveDEU"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="NLD" data-tz="Europe/Berlin">
              <div class="zone-name">Netherland (Europe/Berlin)</div>
              <div class="zone-value" id="liveNLD">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveNLD"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveNLD"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="POL" data-tz="Europe/Warsaw">
              <div class="zone-name">Poland (Europe/Warsaw)</div>
              <div class="zone-value" id="livePOL">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-livePOL"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-livePOL"></div>
              </div>

            </div>
            <div class="zone-row" data-zone="emea" data-key="ESP" data-tz="Europe/Berlin">
              <div class="zone-name">Spain (Europe/Berlin)</div>
              <div class="zone-value" id="liveESP">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveESP"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveESP"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="CHE" data-tz="Europe/Berlin">
              <div class="zone-name">Switzerland (Europe/Berlin)</div>
              <div class="zone-value" id="liveCHE">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveCHE"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveCHE"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="AFR" data-tz="Africa/Johannesburg">
              <div class="zone-name">Africa (Africa/Johannesburg)</div>
              <div class="zone-value" id="liveAFR">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveAFR"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveAFR"></div>
              </div>
            </div>

            <div class="zone-row" data-zone="all" data-key="IST" data-tz="Asia/Kolkata">
              <div class="zone-name">India</div>
              <div class="zone-value" id="liveIST">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveIST"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveIST"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="THA" data-tz="Asia/Bangkok">
              <div class="zone-name">Thailand (Asia/Bangkok)</div>
              <div class="zone-value" id="liveTHA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveTHA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveTHA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="JPN" data-tz="Japan">
              <div class="zone-name">Japan (Japan)</div>
              <div class="zone-value" id="liveJPN">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveJPN"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveJPN"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="SYD" data-tz="Australia/Sydney">
              <div class="zone-name">Australia (Australia/Sydney)</div>
              <div class="zone-value" id="liveSYD">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-liveSYD"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-liveSYD"></div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <div style="margin-top:10px; font-size:12px; color:var(--muted);">
        <strong>Business hours guide:</strong>
        <span style="border-radius:999px; padding:2px 8px; border:1px solid rgba(22,163,74,0.6); margin-left:6px;">Green
          =
          09:00–18:00 (working hours)</span>
        <span
          style="border-radius:999px; padding:2px 8px; border:1px solid rgba(148, 163, 184, 0.4); margin-left:6px;">Grey
          =
          18:00–09:00 (off hours)</span>
        <span style="margin-left:6px;">(local time)</span>
      </div>
    </div>

    <div class="card">
      <h3>Convert IST → Other Zones</h3>

      <div style="display:flex; gap:12px; align-items:flex-start; flex-direction:column;">
        <div style="width:100%;">
          <label class="label">Choose Date & Time (IST):</label>
          <input id="istInput" type="datetime-local" onchange="convertFromIST()" />
        </div>

        <div style="width:100%;">
          <label class="label">Choose Date & Time (EST):</label>
          <input id="estInput" type="datetime-local" onchange="convertFromEST()" />
        </div>
      </div>

      <div style="display:flex; gap:14px; align-items:center; margin-top:8px;">
        <div style="min-width:200px;">
          <label class="label">Select Region:</label>
          <select id="groupSelectConv" onchange="applyGroupConv()">
            <option value="all">All</option>
            <option value="apac">APAC</option>
            <option value="emea">EMEA</option>
            <option value="clar">CLAR</option>
          </select>
        </div>
        <div class="header-controls" style="margin-left:12px;">
          <div>
            <label class="label">Apply Sorting:</label>
            <div>
              <button class="sort-btn" data-target="convTable" data-dir="asc"
                onclick="sortZones('convTable', true)">Ascending</button>

              <button class="sort-btn" data-target="convTable" data-dir="desc"
                onclick="sortZones('convTable', false)">Descending</button>

            </div>
          </div>
        </div>
      </div>

      <div class="prominent">
        <div class="est-box" id="convEstBox">
          <div class="label">Primary — EST</div>
          <div id="convertedEST" class="big">--</div>
          <div class="sub" style="margin-top:6px">America/New_York</div>
        </div>

        <div class="others" id="convertedChips">
          <div class="zone-table" id="convTable">

            <div class="zone-row" data-zone="clar" data-key="MEX" data-tz="America/Mexico_City">
              <div class="zone-name">Mexico (America/Mexico_City)</div>
              <div class="zone-value" id="convertedMEX">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedMEX"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedMEX"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="clar" data-key="CAN" data-tz="America/Toronto">
              <div class="zone-name">Canada (America/Toronto)</div>
              <div class="zone-value" id="convertedCAN">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedCAN"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedCAN"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="clar" data-key="BRA" data-tz="Brazil/East">
              <div class="zone-name">Brazil (Brazil/East)</div>
              <div class="zone-value" id="convertedBRA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedBRA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedBRA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="BER" data-tz="Europe/Berlin">
              <div class="zone-name">Belgium (Europe/Berlin)</div>
              <div class="zone-value" id="convertedBER">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedBER"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedBER"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="FRA" data-tz="Europe/Berlin">
              <div class="zone-name">France (Europe/Berlin)</div>
              <div class="zone-value" id="convertedFRA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedFRA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedFRA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="DEU" data-tz="Europe/Berlin">
              <div class="zone-name">Germany (Europe/Berlin)</div>
              <div class="zone-value" id="convertedDEU">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedDEU"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedDEU"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="NLD" data-tz="Europe/Berlin">
              <div class="zone-name">Netherland (Europe/Berlin)</div>
              <div class="zone-value" id="convertedNLD">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedNLD"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedNLD"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="POL" data-tz="Europe/Warsaw">
              <div class="zone-name">Poland (Europe/Warsaw)</div>
              <div class="zone-value" id="convertedPOL">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedPOL"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedPOL"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="ESP" data-tz="Europe/Berlin">
              <div class="zone-name">Spain (Europe/Berlin)</div>
              <div class="zone-value" id="convertedESP">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedESP"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedESP"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="CHE" data-tz="Europe/Berlin">
              <div class="zone-name">Switzerland (Europe/Berlin)</div>
              <div class="zone-value" id="convertedCHE">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedCHE"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedCHE"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="emea" data-key="AFR" data-tz="Africa/Johannesburg">
              <div class="zone-name">Africa (Africa/Johannesburg)</div>
              <div class="zone-value" id="convertedAFR">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedAFR"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedAFR"></div>
              </div>
            </div>

            <div class="zone-row" data-zone="all" data-key="IST" data-tz="Asia/Kolkata">
              <div class="zone-name">India</div>
              <div class="zone-value" id="convertedIST">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedIST"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedIST"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="THA" data-tz="Asia/Bangkok">
              <div class="zone-name">Thailand (Asia/Bangkok)</div>
              <div class="zone-value" id="convertedTHA">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedTHA"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedTHA"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="JPN" data-tz="Japan">
              <div class="zone-name">Japan (Japan)</div>
              <div class="zone-value" id="convertedJPN">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedJPN"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedJPN"></div>
              </div>
            </div>
            <div class="zone-row" data-zone="apac" data-key="SYD" data-tz="Australia/Sydney">
              <div class="zone-name">Australia (Australia/Sydney)</div>
              <div class="zone-value" id="convertedSYD">--</div>
              <div class="zone-diff-wrap">
                <div class="zone-diff zone-diff-ist" id="diff-ist-convertedSYD"></div>
                <div class="zone-diff zone-diff-utc" id="diff-utc-convertedSYD"></div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <div style="margin-top:12px; color:var(--muted); font-size:13px">
        Note: choose a region to filter which secondary zones are visible.
        Use the sort buttons to order the tables or pick a date to auto-sort the Converted table.
      </div>
    </div>
  </div>

  <script>
    // small safety: ensure elements exist before attaching listeners
    const istInput = document.getElementById('istInput');
    const estInput = document.getElementById('estInput');

    if (istInput && estInput) {
      istInput.addEventListener('input', () => {
        if (istInput.value) {
          estInput.value = "";
          estInput.disabled = true;
        } else {
          estInput.disabled = false;
        }
      });

      estInput.addEventListener('input', () => {
        if (estInput.value) {
          istInput.value = "";
          istInput.disabled = true;
        } else {
          istInput.disabled = false;
        }
      });
    }

    // Groups mapping
    const GROUPS = {
      all: ['all', 'apac', 'emea', 'clar'],
      apac: ['apac'],
      emea: ['emea'],
      clar: ['clar']
    };

    // Get offset (in minutes) from UTC for a timezone at a given instant
    function getOffsetMinutes(instant, timeZone) {
      const fmt = new Intl.DateTimeFormat('en-GB', {
        timeZone,
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });

      const parts = fmt.formatToParts(instant);
      const map = {};
      parts.forEach(p => {
        if (p.type !== 'literal') map[p.type] = p.value;
      });

      const asUTC = Date.UTC(
        Number(map.year),
        Number(map.month) - 1,
        Number(map.day),
        Number(map.hour),
        Number(map.minute),
        Number(map.second)
      );

      // offset = local_time_as_UTC - actual_UTC
      return Math.round((asUTC - instant.getTime()) / 60000);
    }

    // Time difference between given zone with IST and EST, with half-hour support
    function timeDiffLabelIST(tz) {
      const now = new Date();

      const offsetIst = getOffsetMinutes(now, "Asia/Kolkata");
      const offsetOther = getOffsetMinutes(now, tz);

      const diffMinutesist = offsetOther - offsetIst;   // other - IST
      if (diffMinutesist === 0) return "(same as IST)";
      const absMinist = Math.abs(diffMinutesist);
      const hoursist = Math.floor(absMinist / 60);
      const minsist = absMinist % 60;
      const hPartist = hoursist > 0 ? `${hoursist}h` : "";
      const mPartist = minsist > 0 ? `${minsist}m` : "";
      const sepist = hPartist && mPartist ? " " : "";
      const directionist = diffMinutesist > 0 ? "ahead of IST" : "behind IST";

      return `${hPartist}${sepist}${mPartist} ${directionist}`;
    }

    function timeDiffLabelUTC(tz) {
      const now = new Date();
      const offsetgmt = getOffsetMinutes(now, "utc");
      const offsetOther = getOffsetMinutes(now, tz);

      const diffMinutesgmt = offsetOther - offsetgmt;   // other - GMT
      if (diffMinutesgmt === 0) return "(same as UTC)";
      const absMingmt = Math.abs(diffMinutesgmt);
      const hoursgmt = Math.floor(absMingmt / 60);
      const minsgmt = absMingmt % 60;
      const hPartgmt = hoursgmt > 0 ? `${hoursgmt}h` : "";
      const mPartgmt = minsgmt > 0 ? `${minsgmt}m` : "";
      const sepgmt = hPartgmt && mPartgmt ? " " : "";
      const directiongmt = diffMinutesgmt > 0 ? "ahead of UTC" : "behind UTC";
      return `${hPartgmt}${sepgmt}${mPartgmt} ${directiongmt}`;
    }



    // Formatter to DD/MM/YYYY hh:mm:ss am/pm in given timezone
    function fmtForZone(dateObj, timeZone) {
      const opts = {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true,
        timeZone
      };
      return dateObj.toLocaleString('en-GB', opts);
    }

    const AM_CLASS = 'time-am';
    const PM_CLASS = 'time-pm';

    // classify business-hours bucket for a given instant and timezone
    function classifyBusiness(instant, timeZone) {
      const fmt = new Intl.DateTimeFormat('en-GB', {
        timeZone,
        hour: '2-digit',
        hour12: false
      });
      const parts = fmt.formatToParts(instant);
      const hourPart = parts.find(p => p.type === 'hour');
      const hour = hourPart ? parseInt(hourPart.value, 10) : NaN;
      if (isNaN(hour)) return 'off';

      // core: 09:00–18:00, extended: 07:00–09:00 & 18:00–22:00, off: others
      if (hour >= 9 && hour < 18) return 'core';
      if ((hour < 9) || (hour >= 18)) return 'extended';
      return 'off';
    }

    function applyBusinessClassFromElement(timeElement, instant, timeZone) {
      if (!timeElement || !instant) return;
      const row = timeElement.closest('.zone-row') || timeElement.closest('.est-box');
      if (!row) return;

      row.classList.remove('row-business-core', 'row-business-extended', 'row-business-off');
      const bucket = classifyBusiness(instant, timeZone);
      if (bucket === 'core') {
        row.classList.add('row-business-core');
      } else if (bucket === 'extended') {
        row.classList.add('row-business-extended');
      } else {
        row.classList.add('row-business-off');
      }
    }

    function clearBusinessClassFromElement(timeElement) {
      if (!timeElement) return;
      const row = timeElement.closest('.zone-row') || timeElement.closest('.est-box');
      if (!row) return;
      row.classList.remove('row-business-core', 'row-business-extended', 'row-business-off');
    }

    function setTimeWithTone(id, dateObj, timeZone) {
      const el = document.getElementById(id);
      if (!el || !dateObj) return;

      const formatted = fmtForZone(dateObj, timeZone);
      el.innerText = formatted;

      // reset previous tone
      el.classList.remove(AM_CLASS, PM_CLASS);

      const lower = formatted.toLowerCase();
      if (lower.includes(' am')) {
        el.classList.add(AM_CLASS);
      } else if (lower.includes(' pm')) {
        el.classList.add(PM_CLASS);
      }

      // apply business-hours shading
      applyBusinessClassFromElement(el, dateObj, timeZone);
    }

    function clearTimeDisplay(id, text) {
      const el = document.getElementById(id);
      if (!el) return;
      el.innerText = text;
      el.classList.remove(AM_CLASS, PM_CLASS);
      clearBusinessClassFromElement(el);
    }

    function buildDateFromISTInput(val) {
      const parts = val.split('T');
      if (parts.length !== 2) return null;
      const [y, m, d] = parts[0].split('-').map(Number);
      const [hh, mm] = parts[1].split(':').map(Number);
      if ([y, m, d, hh, mm].some(v => Number.isNaN(v))) return null;
      const localUtcMillis = Date.UTC(y, m - 1, d, hh, mm, 0);
      const istOffsetMs = 5.5 * 3600 * 1000; // IST = UTC+5:30
      const utcMillis = localUtcMillis - istOffsetMs;
      return new Date(utcMillis);
    }

    function buildDateFromESTInput(val) {
      const parts = val.split('T');
      if (parts.length !== 2) return null;
      const [y, m, d] = parts[0].split('-').map(Number);
      const [hh, mm] = parts[1].split(':').map(Number);
      if ([y, m, d, hh, mm].some(v => Number.isNaN(v))) return null;
      const localUtcMillis = Date.UTC(y, m - 1, d, hh, mm, 0);
      const estOffsetMs = 5 * 3600 * 1000; // EST = UTC-5:00
      const utcMillis = localUtcMillis + estOffsetMs;
      return new Date(utcMillis);
    }

    // helper: numeric key for timezone at an instant (YYYYMMDDHHMMSS)
    function zoneKeyForInstant(instant, tz) {
      const fmt = new Intl.DateTimeFormat('en-GB', {
        timeZone: tz,
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });
      const parts = fmt.formatToParts(instant);
      const map = {};
      parts.forEach(p => {
        if (p.type !== 'literal') map[p.type] = p.value;
      });
      return Number(map.year + map.month + map.day + map.hour + map.minute + map.second);
    }

    function highlightSort(tableId, asc) {
      const btns = document.querySelectorAll(`button.sort-btn[data-target="${tableId}"]`);
      btns.forEach(btn => btn.classList.remove("active"));

      const selector = asc
        ? `button.sort-btn[data-target="${tableId}"][data-dir="asc"]`
        : `button.sort-btn[data-target="${tableId}"][data-dir="desc"]`;

      const activeBtn = document.querySelector(selector);
      if (activeBtn) activeBtn.classList.add("active");
    }

    // sort rows in a table by timezone local time at a reference instant
    function sortZones(tableId, asc = true, referenceInstant = null) {
      const table = document.getElementById(tableId);
      if (!table) return;
      const rows = Array.from(table.querySelectorAll('.zone-row'));
      const instant = referenceInstant || new Date();
      const decorated = rows.map(r => ({
        r,
        key: zoneKeyForInstant(instant, r.getAttribute('data-tz') || 'UTC')
      }));
      highlightSort(tableId, asc);
      decorated.sort((a, b) => asc ? a.key - b.key : b.key - a.key);
      decorated.forEach(d => table.appendChild(d.r));
    }

    function updateLiveClock() {
      const now = new Date();
      const map = {
        liveEST: 'America/New_York',
        liveIST: 'Asia/Kolkata',
        liveSYD: 'Australia/Sydney',
        liveBER: 'Europe/Berlin',
        liveAFR: 'Africa/Johannesburg',
        liveBRA: 'Brazil/East',
        liveCAN: 'America/Toronto',
        liveFRA: 'Europe/Berlin',
        liveDEU: 'Europe/Berlin',
        liveJPN: 'Japan',
        liveMEX: 'America/Mexico_City',
        liveNLD: 'Europe/Berlin',
        livePOL: 'Europe/Warsaw',
        liveESP: 'Europe/Berlin',
        liveCHE: 'Europe/Berlin',
        liveTHA: 'Asia/Bangkok'
      };

      Object.keys(map).forEach(id => {
        setTimeWithTone(id, now, map[id]);
        const diffIst = document.getElementById("diff-ist-" + id);
        const diffUTC = document.getElementById("diff-utc-" + id);

        if (diffIst) diffIst.innerText = timeDiffLabelIST(map[id]);
        if (diffUTC) diffUTC.innerText = timeDiffLabelUTC(map[id]);

      });

      // Also shade the primary EST live box
      const estBig = document.getElementById('liveEST');
      if (estBig) applyBusinessClassFromElement(estBig, now, 'America/New_York');
    }

    setInterval(updateLiveClock, 1000);
    updateLiveClock();

    function convertFromIST() {
      const val = document.getElementById('istInput').value;
      const keys = ['convertedEST', 'convertedSYD', 'convertedIST', 'convertedBER',
        'convertedAFR', 'convertedBRA', 'convertedCAN', 'convertedFRA', 'convertedDEU',
        'convertedJPN', 'convertedMEX', 'convertedNLD', 'convertedPOL', 'convertedESP', 'convertedCHE', 'convertedTHA'];
      if (!val) {
        keys.forEach(k => {
          clearTimeDisplay(k, '--');
          const diffIst = document.getElementById("diff-ist-" + id);
          const diffUTC = document.getElementById("diff-utc-" + id);

          if (diffIst) diffIst.innerText = timeDiffLabelIST(convMap[id]);
          if (diffUTC) diffUTC.innerText = timeDiffLabelUTC(convMap[id]);
        });
        return;
      }
      const istDateObj = buildDateFromISTInput(val);
      if (!istDateObj || isNaN(istDateObj.getTime())) {
        keys.forEach(k => {
          clearTimeDisplay(k, 'Invalid Date');
          const diffIst = document.getElementById("diff-ist-" + id);
          const diffUTC = document.getElementById("diff-utc-" + id);

          if (diffIst) diffIst.innerText = timeDiffLabelIST(convMap[id]);
          if (diffUTC) diffUTC.innerText = timeDiffLabelUTC(convMap[id]);
        });
        return;
      }

      const convMap = {
        convertedEST: 'America/New_York',
        convertedSYD: 'Australia/Sydney',
        convertedIST: 'Asia/Kolkata',
        convertedBER: 'Europe/Berlin',
        convertedAFR: 'Africa/Johannesburg',
        convertedBRA: 'Brazil/East',
        convertedCAN: 'America/Toronto',
        convertedFRA: 'Europe/Berlin',
        convertedDEU: 'Europe/Berlin',
        convertedJPN: 'Japan',
        convertedMEX: 'America/Mexico_City',
        convertedNLD: 'Europe/Berlin',
        convertedPOL: 'Europe/Warsaw',
        convertedESP: 'Europe/Berlin',
        convertedCHE: 'Europe/Berlin',
        convertedTHA: 'Asia/Bangkok'
      };

      Object.keys(convMap).forEach(id => {
        setTimeWithTone(id, istDateObj, convMap[id]);
        const diffIst = document.getElementById("diff-ist-" + id);
        const diffUTC = document.getElementById("diff-utc-" + id);

        if (diffIst) diffIst.innerText = timeDiffLabelIST(convMap[id]);
        if (diffUTC) diffUTC.innerText = timeDiffLabelUTC(convMap[id]);
      });

      // Shade primary converted EST box as well
      const estBig = document.getElementById('convertedEST');
      if (estBig) applyBusinessClassFromElement(estBig, istDateObj, 'America/New_York');

      // auto-sort converted table ascending by the converted local times for that IST instant
      sortZones('convTable', true, istDateObj);
    }

    function convertFromEST() {
      const val = document.getElementById('estInput').value;
      const keys = ['convertedEST', 'convertedSYD', 'convertedIST', 'convertedBER',
        'convertedAFR', 'convertedBRA', 'convertedCAN', 'convertedFRA', 'convertedDEU',
        'convertedJPN', 'convertedMEX', 'convertedNLD', 'convertedPOL', 'convertedESP', 'convertedCHE', 'convertedTHA'];
      if (!val) {
        keys.forEach(k => clearTimeDisplay(k, '--'));
        return;
      }
      // NOTE: keeping same behavior pattern you already had (IST-style parsing)
      const istDateObj = buildDateFromISTInput(val);
      if (!istDateObj || isNaN(istDateObj.getTime())) {
        keys.forEach(k => clearTimeDisplay(k, 'Invalid Date'));
        return;
      }

      const convMap = {
        convertedEST: 'America/New_York',
        convertedSYD: 'Australia/Sydney',
        convertedIST: 'Asia/Kolkata',
        convertedBER: 'Europe/Berlin',
        convertedAFR: 'Africa/Johannesburg',
        convertedBRA: 'Brazil/East',
        convertedCAN: 'America/Toronto',
        convertedFRA: 'Europe/Berlin',
        convertedDEU: 'Europe/Berlin',
        convertedJPN: 'Japan',
        convertedMEX: 'America/Mexico_City',
        convertedNLD: 'Europe/Berlin',
        convertedPOL: 'Europe/Warsaw',
        convertedESP: 'Europe/Berlin',
        convertedCHE: 'Europe/Berlin',
        convertedTHA: 'Asia/Bangkok'
      };

      Object.keys(convMap).forEach(id => {
        setTimeWithTone(id, istDateObj, convMap[id]);
      });

      const estBig = document.getElementById('convertedEST');
      if (estBig) applyBusinessClassFromElement(estBig, istDateObj, 'America/New_York');

      // auto-sort converted table ascending by the converted local times for that IST instant
      sortZones('convTable', true, istDateObj);
    }

    function applyGroupLive() {
      const sel = document.getElementById('groupSelectLive').value;
      const allowed = GROUPS[sel] || GROUPS.all;
      document.querySelectorAll('#liveTable .zone-row').forEach(el => {
        el.style.display = allowed.includes(el.getAttribute('data-zone') || 'all') ? '' : 'none';
      });
    }

    function applyGroupConv() {
      const sel = document.getElementById('groupSelectConv').value;
      const allowed = GROUPS[sel] || GROUPS.all;
      document.querySelectorAll('#convTable .zone-row').forEach(el => {
        el.style.display = allowed.includes(el.getAttribute('data-zone') || 'all') ? '' : 'none';
      });
    }

    // initialize
    applyGroupLive();
    applyGroupConv();
  </script>
</body>

</html>
